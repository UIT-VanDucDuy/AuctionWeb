<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Quản lý danh mục</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css}" rel="stylesheet"/>
    <link th:href="@{https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css}" rel="stylesheet"/>
    <style>
        .card{border:0;box-shadow:0 6px 18px rgba(0,0,0,.06)}
    </style>
</head>
<body class="bg-light">
<div class="container py-4">

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h3 class="mb-0">Quản lý danh mục</h3>
        <a th:href="@{/admin}" class="btn btn-outline-secondary">Về Dashboard</a>
    </div>

    <!-- Tạo mới -->
    <div class="card p-3 mb-3">
        <form th:action="@{/admin/categories}" th:object="${category}" method="post" class="row g-2 align-items-end">
            <div class="col-md-6">
                <label class="form-label mb-1">Tên danh mục mới</label>
                <input type="text" class="form-control" th:field="*{name}" placeholder="Ví dụ: Điện thoại" required/>
            </div>
            <div class="col-md-3 d-grid">
                <button class="btn btn-primary"><i class="bi bi-plus-lg me-1"></i>Thêm danh mục</button>
            </div>
        </form>
    </div>

    <!-- Danh sách -->
    <div class="card">
        <div class="table-responsive">
            <table class="table align-middle mb-0">
                <thead class="table-light">
                <tr>
                    <th style="width:100px">ID</th>
                    <th>Tên danh mục</th>
                    <th class="text-end" style="width:260px">Thao tác</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="c : ${categories}">
                    <td th:text="${c.id}">1</td>
                    <td th:text="${c.name}">Tên danh mục</td>
                    <td class="text-end">
                        <!-- Nút mở modal sửa -->
                        <button type="button"
                                class="btn btn-sm btn-outline-primary"
                                data-bs-toggle="modal"
                                th:attr="data-bs-target=${'#editCatModal-' + c.id}">
                            <i class="bi bi-pencil-square"></i> Sửa
                        </button>

                        <!-- Xoá -->
                        <form th:action="@{|/admin/categories/${c.id}/delete|}" method="post" class="d-inline"
                              onsubmit="return confirm('Xoá danh mục này?');">
                            <button type="submit" class="btn btn-sm btn-outline-danger">
                                <i class="bi bi-trash"></i> Xoá
                            </button>
                        </form>


                    </td>
                </tr>

                <tr th:if="${#lists.isEmpty(categories)}">
                    <td colspan="3" class="text-center text-muted py-4">Chưa có danh mục nào.</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modals sửa danh mục -->
    <div th:each="c : ${categories}">
        <div class="modal fade"
             th:id="${'editCatModal-' + c.id}"
             tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <form th:action="@{|/admin/categories/${c.id}|}" method="post">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                Sửa danh mục (#<span th:text="${c.id}">id</span>)
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Đóng"></button>
                        </div>
                        <div class="modal-body">
                            <label class="form-label">Tên danh mục</label>
                            <input type="text" name="name" class="form-control" th:value="${c.name}" required/>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Huỷ</button>
                            <button class="btn btn-primary"><i class="bi bi-check2 me-1"></i>Lưu</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

</div>

<script th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js}"></script>
</body>
</html>
